Рассмотрим открытую кинематическую цепь состоящей из простых кинематических звеньев. Свяжем с каждым кинематическим звеном свяжем две локальные системы координат, распожив их в точках сочленения кинематических пар. Таким образом каждое кинематическое звено имеет входную и выходную ЛСК, жестко связанные с ним.

В сочленении кинематической пары также оказывается две системы координат - по одной для каждого звена пары (выходная первого звена и входная второго). Введем кинематические параметры звеньев q_i, определяющих взаимное расположение локальных систем координат.

Таким образом кинематическая цепь определяется цепочкой локальных систем координат, положение каждой из которых определяется положением предыдущей и объектом трансформации СК, либо константным, либо завищим от соответствующего кинематического параметра.

Пронумеруем звенья и системы координат. Пусть неподвижное кинематическое звено, жестко связанное с лабораторной системой координат считается 0-ым, лабораторная система координат считается 0-ой СК, пусть входная система каждого n-ого звена считается n-ой СК. Выходную систему кинематического звена обозначим как n\*. 

Если в нашей цепи n звеньев, то СК выходного звена цепи будет n-ой системой координат. (рассматривать n\* для выходного звена цепи не имеет особого смысла).


Остановимся подробнее на введенном в рассмотрение операторе трансформации систем координат. Этот оператор является тензором гомогенного преобразования, математическое представление которого может быть различным. В частности, для него могут применяться матрицы размерностью 4x4, бикватернионы, комбинация кватерниона поворота и вектора трансляции и т.д. В рамках рассматриваемого метода конкретная форма представления данного оператора взаимозаменяема и определяется исключительно удобством реализации в вычислительной системе. Обозначим этот оператор H(i,j).

Также введем в рассмотрение тензор положения СК. Обозначим его P.

Точно также, не теряя общности рассуждения можно рассмотреть производную данного тензора. dP/dt

dP_s
dt   = sum(ddP_s/dd q_n dq_n) 

В силу линейности координатных преобразований. 
ddP_s / dd q_n = ddP_s' / dd q_n'

 = sum( dd P_s` / dd P_n` * dd P_n` / dd q_n` * q_n' )

 Представим тензор P_n' в векторной форме как пару тензоров (v,w), определяющих линейную и угловую скорости соответствующей СК. При этом выражение 
 dd P_s` / dd P_n` примет форму оператора, вычисляющего состовляющую скоростей (v_s, w_s), вызванных (v_n, w_n). Обозначим этот оператор как R_s_n.

(v_s, w_s) = sum(  R_s_n * dd (v_n,w_n) / dd q_n' * q_n' )

Заметим, что в базисе n выражение dd (v_n,w_n) / dd q_n' является константой и зависит от геометрии конкретного кинематического звена. Обозначим величину (dd (v_n,w_n) / dd q_n')(n) как W_n.

Запишем уравнение (* ) в базисе СК x.
(v_s, w_s)(x) = sum( H_x_n * R_s_n(n) * W_n * q_n' )
(v_s, w_s)(x) = H_x_s(x) * sum( H_s_n(s) * R_s_n(n) * W_n * q_n' )
(v_s, w_s)(s) = sum( H_s_n(s) * R_s_n(qn+1..s)(n) * W_n * q_n' )


Здесь H_x_n - это оператор гомогенного преобразования базиса n в базис x. Для векторных величин (v,w) такое преобразование означает применение вращения без трансляции.

Выражение (* ) является основным соотношением рассматриваемого метода.

Физический смысл его таков: Чтобы 

Обозначим H(i,j) - линейный оператор преобразования j-ой системы координат в i-ую. 

В текущей работе предлагается метод практической реализации алгоритма управления таким изделием.

Таким образом скорость n-ого звена в декартовой системе координат определяется суммой вкладов обобщенных скоростей кинематических коодинат. Вклад конкретной обобщенной скорости явяляется функцией этой скорости и промежуточных обобщенных координат СК (qn', qn+1 ... qs).

Выведенное соотношение соответствует прямой задаче кинематики системы, записанному в дифференциальной форме.

Выражение (* ) можно переписать в виде:
(v_s, w_s)(s) = sum( W_n(q_n ... q_s) * k_n ). Здесь W_n - имеет смысл 6-вектора компоненты скорости, а k_n - некий скалярный множитель. Таким образом (v_s, w_s) является линейной комбинацией векторов W_n(q_n ... q_s).

Зададимся целью найти набор коэффициентов, соответствующих заданной 6-скорости (v_s, w_s). В общем виде задача может иметь одно решение, множество решений или не иметь решений вообще. Можно, однако утверждать, что, если заданный вектор скорости геометрически осмыслен, то задача будет иметь не менее одного решения.

В матричной форме уравнение (* ) может быть записано как:
(v_s, w_s) = A * K = (......)

Это уравнение может быть решено методом поиска псевдообратной матрицы, или каким-либо методом линейного программирования. Поскольку задача имеет множество решений, оптимизируемый функционал может быть введен и использован для выбора конкретного решения.

## Построение следящей системы. 

На основе соотношения (* ) может быть построена следящая система положения выходного (или любого другого) звена. Для этого следует ввести положение уставки U. Тогда ошибка E системы от текущего положения P будет иметь вид:
E = U * P^-1. 

Выбрав базис (рекомендуется работа в базисе непосредственно связанном с контролируемым звеном), переведем E в 6-вектор (r, rho), где r - вектор трансляции, а rho - вектор поворота. Используем соотношение (* ) вычислим набор компонент k_i, такой что (v_s, w_s) будет коллинеарным (r, rho). Вектор k_i определен с точностью до множителя. Длина вектора может быть выбрана из физических характеристик системы и условий наложенных на управление. В простейшем случае длина вектора k_i может линейно зависеть от длины 6-вектора (r_s, rho_s), что будет соответствовать апереодическому процессу регулирования.   

## Построение массива точек для прохода по алгоритму линейной интерполяции. 

Соотношение (* ) может быть применено для построения массива векторов q_i, соответствующих выполнению траектории P_s(t). Для этого следует дискретизировать траекторию P_s(t_i) по массиву 0 < t_i < t. Дискрет может быть выбран из соображений точности траектории и возможностей вычислителя.

Пусть D - тензор перехода между двумя соседними положениями.
D_s_s+1 = P_s+1(q_i) * P_s(q_j)^-1

Вычислим D как 6-вектор (r, rho). Итеративно вычисляя компоненты k_i для текущего модельного положения используем виртуальную следящую систему, переместим виртуальную модельную систему из положения P_s в положение P_s+1. Геометрически это соответствует численному вычислению минимума функции E(q_i) = U * P^-1, методом градиентного спуска. Так как кинематические уравнения в общем случае нелинейны, метод может иметь недостатончно хорошую сходимость. Сходимость метода тем лучше, чем плотнее взят набор точек P_s(t_i).  


